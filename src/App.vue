<script setup lang="ts">
import { ref, onMounted } from 'vue'

const num = ref({ numText: 0 })
const text = ref()

const numChange = () => {
  gsap.to(num.value, {
    duration: 20,
    numText: num.value.numText + 10,
    onUpdate: () => {
      num.value.numText = parseFloat(num.value.numText.toFixed(2))
    },
    ease: 'sine',
  })
}

const imgEl = ref()

onMounted(() => {
  const str = new SplitText(text.value, { type: 'words,chars' })
  console.log(str)
  const chars = str.chars
  const tl = gsap.timeline()
  gsap.set('.text', { perspective: 400 })
  tl.from(chars, {
    duration: 0.3,
    opacity: 0,
    rotation: 90,
    scale: 0,
    x: 20,
    y: 60,
    ease: 'easeOut',
    stagger: 0.05,
  })

  const wh = window.innerHeight
  document.addEventListener('scroll', function () {
    const { bottom, top, height } = imgEl.value.getBoundingClientRect()
    console.log(bottom, top, height)
    if (bottom <= 0 || top >= wh) return
    const y = document.documentElement.scrollTop * 0.15
    imgEl.value.style.transform = `translate3d(0, -${y}px, 0) scale(1.3)`
  })
})

let svgButton = {
  svg: null,
  rect: null,
  play: false,
  front: null,
  back: null,
  path: null,
  viewBox: null,
  points: [],
  sort: [],
  sort_by_x: [],
  step: 8,
  delay: 0.0015,
  radius: 12,
  tweens: [],
}
</script>

<template>
  <div class="mt-6 flex justify-center items-center flex-col">
    <span>{{ num.numText }}</span>
    <div class="btn">
      <button @click="numChange">点击+10</button>
    </div>

    <div class="max-w-sm" ref="text">
      SplitText makes it easy to break apart the text in an HTML element so that
      each character, word, and/or line is wrapped in its own div tag
    </div>
  </div>

  <div class="imgbox">
    <img
      ref="imgEl"
      src="http://www.themustafacelik.com/wp-content/uploads/2018/03/bandsome.jpg"
      alt=""
    />
  </div>

  <svg viewBox="0 0 350 140">
    <path
      d="M 315,70 L 314.07720947265625,77.92926788330078 L 311.3800354003906,85.44218444824219 L 307.0496520996094,92.1482162475586 L 301.3210144042969,97.7077865600586 L 294.4877014160156,101.83432006835938 L 286.8964538574219,104.30245971679688 L 278.94287109375,105.00001525878906 L 270.94287109375,105.00001525878906 L 262.94287109375,105.00001525878906 L 254.94287109375,105.00001525878906 L 246.94287109375,105.00001525878906 L 238.94287109375,105.00001525878906 L 230.94287109375,105.00001525878906 L 222.94287109375,105.00001525878906 L 214.94287109375,105.00001525878906 L 206.94287109375,105.00001525878906 L 198.94287109375,105.00000762939453 L 190.94287109375,105.00000762939453 L 182.94287109375,105.00000762939453 L 174.94287109375,105.00000762939453 L 166.94287109375,105.00000762939453 L 158.94287109375,105.00000762939453 L 150.94287109375,105.00000762939453 L 142.94287109375,105.00000762939453 L 134.94287109375,105.00000762939453 L 126.94287109375,105.00000762939453 L 118.94287109375,105.00000762939453 L 110.94287109375,105 L 102.94287109375,105 L 94.94287109375,105 L 86.94287109375,105 L 78.94287109375,105 L 70.94287109375,105 L 62.9915771484375,104.27970886230469 L 55.408416748046875,101.7867202758789 L 48.58852005004883,97.63793182373047 L 42.877925872802734,92.05980682373047 L 38.569339752197266,85.33971405029297 L 35.89683532714844,77.81792449951172 L 35.00050735473633,69.88568115234375 L 35.94894027709961,61.95944595336914 L 38.670711517333984,54.455360412597656 L 43.022926330566406,47.7634162902832 L 48.76958084106445,42.22241973876953 L 55.61630630493164,38.11814880371094 L 63.21567153930664,35.67496871948242 L 71.1715087890625,35.000003814697266 L 79.1715087890625,35.000003814697266 L 87.1715087890625,35.000003814697266 L 95.1715087890625,35.000003814697266 L 103.1715087890625,35.000003814697266 L 111.1715087890625,35.000003814697266 L 119.1715087890625,35.000003814697266 L 127.1715087890625,35.000003814697266 L 135.1715087890625,35.000003814697266 L 143.1715087890625,35.000003814697266 L 151.1715087890625,35.000003814697266 L 159.1715087890625,35.000003814697266 L 167.1715087890625,35.000003814697266 L 175.1715087890625,35 L 183.1715087890625,35 L 191.1715087890625,35 L 199.1715087890625,35 L 207.1715087890625,35 L 215.1715087890625,35 L 223.1715087890625,35 L 231.1715087890625,35 L 239.1715087890625,35 L 247.1715087890625,35 L 255.1715087890625,35 L 263.1715087890625,35 L 271.1715087890625,35 L 279.1715087890625,35 L 287.1203918457031,35.743629455566406 L 294.6952819824219,38.261470794677734 L 301.5015563964844,42.43242645263672 L 307.194091796875,48.02898406982422 L 311.48077392578125,54.763038635253906 L 314.128662109375,62.29350662231445 L 315,70 "
      class="b fill-green"
    ></path>
    <path
      d="M 315,70 L 314.07720947265625,77.92926788330078 L 311.3800354003906,85.44218444824219 L 307.0496520996094,92.1482162475586 L 301.3210144042969,97.7077865600586 L 294.4877014160156,101.83432006835938 L 286.8964538574219,104.30245971679688 L 278.94287109375,105.00001525878906 L 270.94287109375,105.00001525878906 L 262.94287109375,105.00001525878906 L 254.94287109375,105.00001525878906 L 246.94287109375,105.00001525878906 L 238.94287109375,105.00001525878906 L 230.94287109375,105.00001525878906 L 222.94287109375,105.00001525878906 L 214.94287109375,105.00001525878906 L 206.94287109375,105.00001525878906 L 198.94287109375,105.00000762939453 L 190.94287109375,105.00000762939453 L 182.94287109375,105.00000762939453 L 174.94287109375,105.00000762939453 L 166.94287109375,105.00000762939453 L 158.94287109375,105.00000762939453 L 150.94287109375,105.00000762939453 L 142.94287109375,105.00000762939453 L 134.94287109375,105.00000762939453 L 126.94287109375,105.00000762939453 L 118.94287109375,105.00000762939453 L 110.94287109375,105 L 102.94287109375,105 L 94.94287109375,105 L 86.94287109375,105 L 78.94287109375,105 L 70.94287109375,105 L 62.9915771484375,104.27970886230469 L 55.408416748046875,101.7867202758789 L 48.58852005004883,97.63793182373047 L 42.877925872802734,92.05980682373047 L 38.569339752197266,85.33971405029297 L 35.89683532714844,77.81792449951172 L 35.00050735473633,69.88568115234375 L 35.94894027709961,61.95944595336914 L 38.670711517333984,54.455360412597656 L 43.022926330566406,47.7634162902832 L 48.76958084106445,42.22241973876953 L 55.61630630493164,38.11814880371094 L 63.21567153930664,35.67496871948242 L 71.1715087890625,35.000003814697266 L 79.1715087890625,35.000003814697266 L 87.1715087890625,35.000003814697266 L 95.1715087890625,35.000003814697266 L 103.1715087890625,35.000003814697266 L 111.1715087890625,35.000003814697266 L 119.1715087890625,35.000003814697266 L 127.1715087890625,35.000003814697266 L 135.1715087890625,35.000003814697266 L 143.1715087890625,35.000003814697266 L 151.1715087890625,35.000003814697266 L 159.1715087890625,35.000003814697266 L 167.1715087890625,35.000003814697266 L 175.1715087890625,35 L 183.1715087890625,35 L 191.1715087890625,35 L 199.1715087890625,35 L 207.1715087890625,35 L 215.1715087890625,35 L 223.1715087890625,35 L 231.1715087890625,35 L 239.1715087890625,35 L 247.1715087890625,35 L 255.1715087890625,35 L 263.1715087890625,35 L 271.1715087890625,35 L 279.1715087890625,35 L 287.1203918457031,35.743629455566406 L 294.6952819824219,38.261470794677734 L 301.5015563964844,42.43242645263672 L 307.194091796875,48.02898406982422 L 311.48077392578125,54.763038635253906 L 314.128662109375,62.29350662231445 L 315,69.99921460183982 "
      class="f fill-dgreen"
    ></path>
  </svg>
</template>

<style lang="scss" scoped>
.imgbox {
  height: 450px;
  overflow: hidden;
  margin-top: 800px;
  background-color: pink;
  img {
    width: 100%;
    object-fit: cover;
    transform: translate3d(0, 0, 0) scale(1.3);
  }
}
</style>
<style>
body {
  height: 4000px;
}

.activeClass {
  background-color: yellow;
}
</style>
